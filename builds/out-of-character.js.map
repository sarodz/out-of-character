{"version":3,"file":"out-of-character.js","sources":["../src/match.js","../src/index.js"],"sourcesContent":["const data = require('../data/characters.json')\n\n/** add spaces at the end */\nconst padStr = function (str, width) {\n  while (str.length < width) {\n    str = '0' + str\n  }\n  return str\n}\n\n// for easier look-up\nconst byCode = data.reduce((h, obj) => {\n  h[obj.code] = obj\n  return h\n}, {})\n\n// chars to create our regex with\nlet codes = data\n  .filter((obj) => obj.replaceWith !== undefined)\n  .map((obj) => {\n    return obj.code.replace(/^U\\+/, '\\\\u')\n  })\n\n// return an array of found invisible characters\nconst findAll = function (text) {\n  // console.log(codes)\n  const regEx = new RegExp(`(${codes.join('|')})`, 'g')\n  let matches = []\n  text.replace(regEx, (ch, _b, offset) => {\n    // find the code of the char we matched\n    let code = ch.charCodeAt(0)\n    let hex = code.toString(16).toUpperCase()\n    hex = `U+` + padStr(hex, 4)\n    // console.log(ch, code, hex)\n    let found = byCode[hex] || {}\n    matches.push({\n      name: found.name,\n      code: found.code,\n      offset: offset,\n      replacement: found.replaceWith || '',\n    })\n    return ch //do nothing\n  })\n  return matches\n}\nmodule.exports = findAll\n","const findAll = require('./match')\n\nmodule.exports = {\n  // find invisible or strange unicode characters in the text\n  detect: (text) => {\n    let matches = findAll(text)\n    if (matches.length > 0) {\n      return matches\n    }\n    return null\n  },\n  // remove invisible or strange unicode characters from the text\n  replace: (text) => {\n    let matches = findAll(text)\n    matches.forEach((o) => {\n      let code = o.code.replace(/^U\\+/, '\\\\u')\n      let reg = new RegExp(code, 'g')\n      text = text.replace(reg, o.replacement || '')\n    })\n    return text\n  },\n}\n"],"names":["padStr","str","width","length","byCode","data","reduce","h","obj","code","codes","filter","replaceWith","undefined","map","replace","findAll","text","regEx","RegExp","join","matches","ch","_b","offset","charCodeAt","hex","toString","toUpperCase","found","push","name","replacement","detect","forEach","o","reg"],"mappings":"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"}